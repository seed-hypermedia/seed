#!/usr/bin/env bun
// @bun
var Lb=Object.create;var{getPrototypeOf:Ub,defineProperty:C1,getOwnPropertyNames:_b}=Object;var Nb=Object.prototype.hasOwnProperty;var l=($,K,Y)=>{Y=$!=null?Lb(Ub($)):{};let Q=K||!$||!$.__esModule?C1(Y,"default",{value:$,enumerable:!0}):Y;for(let X of _b($))if(!Nb.call(Q,X))C1(Q,X,{get:()=>$[X],enumerable:!0});return Q};var E1=($,K)=>()=>(K||$((K={exports:{}}).exports,K),K.exports);var B1=E1((h9,m1)=>{var q1={to($,K){if(!K)return`\x1B[${$+1}G`;return`\x1B[${K+1};${$+1}H`},move($,K){let Y="";if($<0)Y+=`\x1B[${-$}D`;else if($>0)Y+=`\x1B[${$}C`;if(K<0)Y+=`\x1B[${-K}A`;else if(K>0)Y+=`\x1B[${K}B`;return Y},up:($=1)=>`\x1B[${$}A`,down:($=1)=>`\x1B[${$}B`,forward:($=1)=>`\x1B[${$}C`,backward:($=1)=>`\x1B[${$}D`,nextLine:($=1)=>"\x1B[E".repeat($),prevLine:($=1)=>"\x1B[F".repeat($),left:"\x1B[G",hide:"\x1B[?25l",show:"\x1B[?25h",save:"\x1B7",restore:"\x1B8"},jb={up:($=1)=>"\x1B[S".repeat($),down:($=1)=>"\x1B[T".repeat($)},Rb={screen:"\x1B[2J",up:($=1)=>"\x1B[1J".repeat($),down:($=1)=>"\x1B[J".repeat($),line:"\x1B[2K",lineEnd:"\x1B[K",lineStart:"\x1B[1K",lines($){let K="";for(let Y=0;Y<$;Y++)K+=this.line+(Y<$-1?q1.up():"");if($)K+=q1.left;return K}};m1.exports={cursor:q1,scroll:jb,erase:Rb,beep:"\x07"}});var W1=E1((D9,J1)=>{var i=process||{},v1=i.argv||[],n=i.env||{},kb=!(!!n.NO_COLOR||v1.includes("--no-color"))&&(!!n.FORCE_COLOR||v1.includes("--color")||i.platform==="win32"||(i.stdout||{}).isTTY&&n.TERM!=="dumb"||!!n.CI),yb=($,K,Y=$)=>(Q)=>{let X=""+Q,x=X.indexOf(K,$.length);return~x?$+wb(X,K,Y,x)+K:$+X+K},wb=($,K,Y,Q)=>{let X="",x=0;do X+=$.substring(x,Q)+Y,x=Q+K.length,Q=$.indexOf(K,x);while(~Q);return X+$.substring(x)},f1=($=kb)=>{let K=$?yb:()=>String;return{isColorSupported:$,reset:K("\x1B[0m","\x1B[0m"),bold:K("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m"),dim:K("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"),italic:K("\x1B[3m","\x1B[23m"),underline:K("\x1B[4m","\x1B[24m"),inverse:K("\x1B[7m","\x1B[27m"),hidden:K("\x1B[8m","\x1B[28m"),strikethrough:K("\x1B[9m","\x1B[29m"),black:K("\x1B[30m","\x1B[39m"),red:K("\x1B[31m","\x1B[39m"),green:K("\x1B[32m","\x1B[39m"),yellow:K("\x1B[33m","\x1B[39m"),blue:K("\x1B[34m","\x1B[39m"),magenta:K("\x1B[35m","\x1B[39m"),cyan:K("\x1B[36m","\x1B[39m"),white:K("\x1B[37m","\x1B[39m"),gray:K("\x1B[90m","\x1B[39m"),bgBlack:K("\x1B[40m","\x1B[49m"),bgRed:K("\x1B[41m","\x1B[49m"),bgGreen:K("\x1B[42m","\x1B[49m"),bgYellow:K("\x1B[43m","\x1B[49m"),bgBlue:K("\x1B[44m","\x1B[49m"),bgMagenta:K("\x1B[45m","\x1B[49m"),bgCyan:K("\x1B[46m","\x1B[49m"),bgWhite:K("\x1B[47m","\x1B[49m"),blackBright:K("\x1B[90m","\x1B[39m"),redBright:K("\x1B[91m","\x1B[39m"),greenBright:K("\x1B[92m","\x1B[39m"),yellowBright:K("\x1B[93m","\x1B[39m"),blueBright:K("\x1B[94m","\x1B[39m"),magentaBright:K("\x1B[95m","\x1B[39m"),cyanBright:K("\x1B[96m","\x1B[39m"),whiteBright:K("\x1B[97m","\x1B[39m"),bgBlackBright:K("\x1B[100m","\x1B[49m"),bgRedBright:K("\x1B[101m","\x1B[49m"),bgGreenBright:K("\x1B[102m","\x1B[49m"),bgYellowBright:K("\x1B[103m","\x1B[49m"),bgBlueBright:K("\x1B[104m","\x1B[49m"),bgMagentaBright:K("\x1B[105m","\x1B[49m"),bgCyanBright:K("\x1B[106m","\x1B[49m"),bgWhiteBright:K("\x1B[107m","\x1B[49m")}};J1.exports=f1();J1.exports.createColors=f1});import{stripVTControlCharacters as S1}from"util";var _=l(B1(),1),l1=l(W1(),1);import{stdin as h1,stdout as D1}from"process";import*as m from"readline";import F1 from"readline";import{WriteStream as Cb}from"tty";function Eb({onlyFirst:$=!1}={}){let K=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?(?:\\u0007|\\u001B\\u005C|\\u009C))","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-nq-uy=><~]))"].join("|");return new RegExp(K,$?void 0:"g")}var mb=Eb();function n1($){if(typeof $!="string")throw TypeError(`Expected a \`string\`, got \`${typeof $}\``);return $.replace(mb,"")}function i1($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}var a1={exports:{}};(function($){var K={};$.exports=K,K.eastAsianWidth=function(Q){var X=Q.charCodeAt(0),x=Q.length==2?Q.charCodeAt(1):0,b=X;return 55296<=X&&X<=56319&&56320<=x&&x<=57343&&(X&=1023,x&=1023,b=X<<10|x,b+=65536),b==12288||65281<=b&&b<=65376||65504<=b&&b<=65510?"F":b==8361||65377<=b&&b<=65470||65474<=b&&b<=65479||65482<=b&&b<=65487||65490<=b&&b<=65495||65498<=b&&b<=65500||65512<=b&&b<=65518?"H":4352<=b&&b<=4447||4515<=b&&b<=4519||4602<=b&&b<=4607||9001<=b&&b<=9002||11904<=b&&b<=11929||11931<=b&&b<=12019||12032<=b&&b<=12245||12272<=b&&b<=12283||12289<=b&&b<=12350||12353<=b&&b<=12438||12441<=b&&b<=12543||12549<=b&&b<=12589||12593<=b&&b<=12686||12688<=b&&b<=12730||12736<=b&&b<=12771||12784<=b&&b<=12830||12832<=b&&b<=12871||12880<=b&&b<=13054||13056<=b&&b<=19903||19968<=b&&b<=42124||42128<=b&&b<=42182||43360<=b&&b<=43388||44032<=b&&b<=55203||55216<=b&&b<=55238||55243<=b&&b<=55291||63744<=b&&b<=64255||65040<=b&&b<=65049||65072<=b&&b<=65106||65108<=b&&b<=65126||65128<=b&&b<=65131||110592<=b&&b<=110593||127488<=b&&b<=127490||127504<=b&&b<=127546||127552<=b&&b<=127560||127568<=b&&b<=127569||131072<=b&&b<=194367||177984<=b&&b<=196605||196608<=b&&b<=262141?"W":32<=b&&b<=126||162<=b&&b<=163||165<=b&&b<=166||b==172||b==175||10214<=b&&b<=10221||10629<=b&&b<=10630?"Na":b==161||b==164||167<=b&&b<=168||b==170||173<=b&&b<=174||176<=b&&b<=180||182<=b&&b<=186||188<=b&&b<=191||b==198||b==208||215<=b&&b<=216||222<=b&&b<=225||b==230||232<=b&&b<=234||236<=b&&b<=237||b==240||242<=b&&b<=243||247<=b&&b<=250||b==252||b==254||b==257||b==273||b==275||b==283||294<=b&&b<=295||b==299||305<=b&&b<=307||b==312||319<=b&&b<=322||b==324||328<=b&&b<=331||b==333||338<=b&&b<=339||358<=b&&b<=359||b==363||b==462||b==464||b==466||b==468||b==470||b==472||b==474||b==476||b==593||b==609||b==708||b==711||713<=b&&b<=715||b==717||b==720||728<=b&&b<=731||b==733||b==735||768<=b&&b<=879||913<=b&&b<=929||931<=b&&b<=937||945<=b&&b<=961||963<=b&&b<=969||b==1025||1040<=b&&b<=1103||b==1105||b==8208||8211<=b&&b<=8214||8216<=b&&b<=8217||8220<=b&&b<=8221||8224<=b&&b<=8226||8228<=b&&b<=8231||b==8240||8242<=b&&b<=8243||b==8245||b==8251||b==8254||b==8308||b==8319||8321<=b&&b<=8324||b==8364||b==8451||b==8453||b==8457||b==8467||b==8470||8481<=b&&b<=8482||b==8486||b==8491||8531<=b&&b<=8532||8539<=b&&b<=8542||8544<=b&&b<=8555||8560<=b&&b<=8569||b==8585||8592<=b&&b<=8601||8632<=b&&b<=8633||b==8658||b==8660||b==8679||b==8704||8706<=b&&b<=8707||8711<=b&&b<=8712||b==8715||b==8719||b==8721||b==8725||b==8730||8733<=b&&b<=8736||b==8739||b==8741||8743<=b&&b<=8748||b==8750||8756<=b&&b<=8759||8764<=b&&b<=8765||b==8776||b==8780||b==8786||8800<=b&&b<=8801||8804<=b&&b<=8807||8810<=b&&b<=8811||8814<=b&&b<=8815||8834<=b&&b<=8835||8838<=b&&b<=8839||b==8853||b==8857||b==8869||b==8895||b==8978||9312<=b&&b<=9449||9451<=b&&b<=9547||9552<=b&&b<=9587||9600<=b&&b<=9615||9618<=b&&b<=9621||9632<=b&&b<=9633||9635<=b&&b<=9641||9650<=b&&b<=9651||9654<=b&&b<=9655||9660<=b&&b<=9661||9664<=b&&b<=9665||9670<=b&&b<=9672||b==9675||9678<=b&&b<=9681||9698<=b&&b<=9701||b==9711||9733<=b&&b<=9734||b==9737||9742<=b&&b<=9743||9748<=b&&b<=9749||b==9756||b==9758||b==9792||b==9794||9824<=b&&b<=9825||9827<=b&&b<=9829||9831<=b&&b<=9834||9836<=b&&b<=9837||b==9839||9886<=b&&b<=9887||9918<=b&&b<=9919||9924<=b&&b<=9933||9935<=b&&b<=9953||b==9955||9960<=b&&b<=9983||b==10045||b==10071||10102<=b&&b<=10111||11093<=b&&b<=11097||12872<=b&&b<=12879||57344<=b&&b<=63743||65024<=b&&b<=65039||b==65533||127232<=b&&b<=127242||127248<=b&&b<=127277||127280<=b&&b<=127337||127344<=b&&b<=127386||917760<=b&&b<=917999||983040<=b&&b<=1048573||1048576<=b&&b<=1114109?"A":"N"},K.characterLength=function(Q){var X=this.eastAsianWidth(Q);return X=="F"||X=="W"||X=="A"?2:1};function Y(Q){return Q.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]|[^\uD800-\uDFFF]/g)||[]}K.length=function(Q){for(var X=Y(Q),x=0,b=0;b<X.length;b++)x=x+this.characterLength(X[b]);return x},K.slice=function(Q,X,x){textLen=K.length(Q),X=X||0,x=x||1,X<0&&(X=textLen+X),x<0&&(x=textLen+x);for(var b="",Z=0,G=Y(Q),z=0;z<G.length;z++){var J=G[z],B=K.length(J);if(Z>=X-(B==2?1:0))if(Z+B<=x)b+=J;else break;Z+=B}return b}})(a1);var vb=a1.exports,fb=i1(vb),Fb=function(){return/\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|(?:\uD83E\uDDD1\uD83C\uDFFF\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFE])|(?:\uD83E\uDDD1\uD83C\uDFFE\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFD\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFC\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|(?:\uD83E\uDDD1\uD83C\uDFFB\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83E\uDDD1|\uD83D\uDC69\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69]))(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC68(?:\uD83C\uDFFB(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|[\u2695\u2696\u2708]\uFE0F|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))?|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFF]))|\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])\uFE0F|\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D[\uDC66\uDC67])|\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC)?|(?:\uD83D\uDC69(?:\uD83C\uDFFB\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|(?:\uD83C[\uDFFC-\uDFFF])\u200D\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1)(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC69(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69])|\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83E\uDDD1(?:\u200D(?:\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFF\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFE\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFD\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFC\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\uD83C\uDFFB\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD]))|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D\uD83D\uDC69\u200D(?:\uD83D[\uDC66\uDC67])|\uD83D\uDC69\u200D\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83E\uDDD1(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|\uD83D\uDC69(?:\uD83C\uDFFF\u200D[\u2695\u2696\u2708]|\uD83C\uDFFE\u200D[\u2695\u2696\u2708]|\uD83C\uDFFD\u200D[\u2695\u2696\u2708]|\uD83C\uDFFC\u200D[\u2695\u2696\u2708]|\uD83C\uDFFB\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|\uD83D\uDE36\u200D\uD83C\uDF2B|\uD83C\uDFF3\uFE0F\u200D\u26A7|\uD83D\uDC3B\u200D\u2744|(?:(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])\u200D[\u2640\u2642]|[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u2328\u23CF\u23ED-\u23EF\u23F1\u23F2\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB\u25FC\u2600-\u2604\u260E\u2611\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u2692\u2694-\u2697\u2699\u269B\u269C\u26A0\u26A7\u26B0\u26B1\u26C8\u26CF\u26D1\u26D3\u26E9\u26F0\u26F1\u26F4\u26F7\u26F8\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2763\u27A1\u2934\u2935\u2B05-\u2B07\u3030\u303D\u3297\u3299]|\uD83C[\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE37\uDF21\uDF24-\uDF2C\uDF36\uDF7D\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFCD\uDFCE\uDFD4-\uDFDF\uDFF5\uDFF7]|\uD83D[\uDC3F\uDCFD\uDD49\uDD4A\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83D\uDC69\u200D\uD83D\uDC67|\uD83D\uDC69\u200D\uD83D\uDC66|\uD83D\uDE35\u200D\uD83D\uDCAB|\uD83D\uDE2E\u200D\uD83D\uDCA8|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83E\uDDD1(?:\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC|\uD83C\uDFFB)?|\uD83D\uDC69(?:\uD83C\uDFFF|\uD83C\uDFFE|\uD83C\uDFFD|\uD83C\uDFFC|\uD83C\uDFFB)?|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83D\uDC08\u200D\u2B1B|\u2764\uFE0F\u200D(?:\uD83D\uDD25|\uD83E\uDE79)|\uD83D\uDC41\uFE0F|\uD83C\uDFF3\uFE0F|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|[#\*0-9]\uFE0F\u20E3|\u2764\uFE0F|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|\uD83C\uDFF4|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270C\u270D]|\uD83D[\uDD74\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|[\u270A\u270B]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC08\uDC15\uDC3B\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC6B-\uDC6D\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDC8F\uDC91\uDCAA\uDD7A\uDD95\uDD96\uDE2E\uDE35\uDE36\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD34\uDD36\uDD77\uDDB5\uDDB6\uDDBB\uDDD2\uDDD3\uDDD5]|\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD4\uDDD6-\uDDDD]|\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF]|[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF84\uDF86-\uDF93\uDFA0-\uDFC1\uDFC5\uDFC6\uDFC8\uDFC9\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC07\uDC09-\uDC14\uDC16-\uDC3A\uDC3C-\uDC3E\uDC40\uDC44\uDC45\uDC51-\uDC65\uDC6A\uDC79-\uDC7B\uDC7D-\uDC80\uDC84\uDC88-\uDC8E\uDC90\uDC92-\uDCA9\uDCAB-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDDA4\uDDFB-\uDE2D\uDE2F-\uDE34\uDE37-\uDE44\uDE48-\uDE4A\uDE80-\uDEA2\uDEA4-\uDEB3\uDEB7-\uDEBF\uDEC1-\uDEC5\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0D\uDD0E\uDD10-\uDD17\uDD1D\uDD20-\uDD25\uDD27-\uDD2F\uDD3A\uDD3F-\uDD45\uDD47-\uDD76\uDD78\uDD7A-\uDDB4\uDDB7\uDDBA\uDDBC-\uDDCB\uDDD0\uDDE0-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDED5-\uDED7\uDEEB\uDEEC\uDEF4-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6])\uFE0F|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDC8F\uDC91\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1F\uDD26\uDD30-\uDD39\uDD3C-\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])/g},db=i1(Fb);function p($,K={}){if(typeof $!="string"||$.length===0||(K={ambiguousIsNarrow:!0,...K},$=n1($),$.length===0))return 0;$=$.replace(db(),"  ");let Y=K.ambiguousIsNarrow?1:2,Q=0;for(let X of $){let x=X.codePointAt(0);if(x<=31||x>=127&&x<=159||x>=768&&x<=879)continue;switch(fb.eastAsianWidth(X)){case"F":case"W":Q+=2;break;case"A":Q+=Y;break;default:Q+=1}}return Q}var z1=10,d1=($=0)=>(K)=>`\x1B[${K+$}m`,g1=($=0)=>(K)=>`\x1B[${38+$};5;${K}m`,c1=($=0)=>(K,Y,Q)=>`\x1B[${38+$};2;${K};${Y};${Q}m`,P={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};Object.keys(P.modifier);var gb=Object.keys(P.color),cb=Object.keys(P.bgColor);[...gb,...cb];function ub(){let $=new Map;for(let[K,Y]of Object.entries(P)){for(let[Q,X]of Object.entries(Y))P[Q]={open:`\x1B[${X[0]}m`,close:`\x1B[${X[1]}m`},Y[Q]=P[Q],$.set(X[0],X[1]);Object.defineProperty(P,K,{value:Y,enumerable:!1})}return Object.defineProperty(P,"codes",{value:$,enumerable:!1}),P.color.close="\x1B[39m",P.bgColor.close="\x1B[49m",P.color.ansi=d1(),P.color.ansi256=g1(),P.color.ansi16m=c1(),P.bgColor.ansi=d1(z1),P.bgColor.ansi256=g1(z1),P.bgColor.ansi16m=c1(z1),Object.defineProperties(P,{rgbToAnsi256:{value:(K,Y,Q)=>K===Y&&Y===Q?K<8?16:K>248?231:Math.round((K-8)/247*24)+232:16+36*Math.round(K/255*5)+6*Math.round(Y/255*5)+Math.round(Q/255*5),enumerable:!1},hexToRgb:{value:(K)=>{let Y=/[a-f\d]{6}|[a-f\d]{3}/i.exec(K.toString(16));if(!Y)return[0,0,0];let[Q]=Y;Q.length===3&&(Q=[...Q].map((x)=>x+x).join(""));let X=Number.parseInt(Q,16);return[X>>16&255,X>>8&255,X&255]},enumerable:!1},hexToAnsi256:{value:(K)=>P.rgbToAnsi256(...P.hexToRgb(K)),enumerable:!1},ansi256ToAnsi:{value:(K)=>{if(K<8)return 30+K;if(K<16)return 90+(K-8);let Y,Q,X;if(K>=232)Y=((K-232)*10+8)/255,Q=Y,X=Y;else{K-=16;let Z=K%36;Y=Math.floor(K/36)/5,Q=Math.floor(Z/6)/5,X=Z%6/5}let x=Math.max(Y,Q,X)*2;if(x===0)return 30;let b=30+(Math.round(X)<<2|Math.round(Q)<<1|Math.round(Y));return x===2&&(b+=60),b},enumerable:!1},rgbToAnsi:{value:(K,Y,Q)=>P.ansi256ToAnsi(P.rgbToAnsi256(K,Y,Q)),enumerable:!1},hexToAnsi:{value:(K)=>P.ansi256ToAnsi(P.hexToAnsi256(K)),enumerable:!1}}),P}var pb=ub(),s=new Set(["\x1B","\x9B"]),rb=39,H1="\x07",t1="[",ob="]",s1="m",M1=`${ob}8;;`,u1=($)=>`${s.values().next().value}${t1}${$}${s1}`,p1=($)=>`${s.values().next().value}${M1}${$}${H1}`,hb=($)=>$.split(" ").map((K)=>p(K)),G1=($,K,Y)=>{let Q=[...K],X=!1,x=!1,b=p(n1($[$.length-1]));for(let[Z,G]of Q.entries()){let z=p(G);if(b+z<=Y?$[$.length-1]+=G:($.push(G),b=0),s.has(G)&&(X=!0,x=Q.slice(Z+1).join("").startsWith(M1)),X){x?G===H1&&(X=!1,x=!1):G===s1&&(X=!1);continue}b+=z,b===Y&&Z<Q.length-1&&($.push(""),b=0)}!b&&$[$.length-1].length>0&&$.length>1&&($[$.length-2]+=$.pop())},Db=($)=>{let K=$.split(" "),Y=K.length;for(;Y>0&&!(p(K[Y-1])>0);)Y--;return Y===K.length?$:K.slice(0,Y).join(" ")+K.slice(Y).join("")},lb=($,K,Y={})=>{if(Y.trim!==!1&&$.trim()==="")return"";let Q="",X,x,b=hb($),Z=[""];for(let[z,J]of $.split(" ").entries()){Y.trim!==!1&&(Z[Z.length-1]=Z[Z.length-1].trimStart());let B=p(Z[Z.length-1]);if(z!==0&&(B>=K&&(Y.wordWrap===!1||Y.trim===!1)&&(Z.push(""),B=0),(B>0||Y.trim===!1)&&(Z[Z.length-1]+=" ",B++)),Y.hard&&b[z]>K){let W=K-B,V=1+Math.floor((b[z]-W-1)/K);Math.floor((b[z]-1)/K)<V&&Z.push(""),G1(Z,J,K);continue}if(B+b[z]>K&&B>0&&b[z]>0){if(Y.wordWrap===!1&&B<K){G1(Z,J,K);continue}Z.push("")}if(B+b[z]>K&&Y.wordWrap===!1){G1(Z,J,K);continue}Z[Z.length-1]+=J}Y.trim!==!1&&(Z=Z.map((z)=>Db(z)));let G=[...Z.join(`
`)];for(let[z,J]of G.entries()){if(Q+=J,s.has(J)){let{groups:W}=new RegExp(`(?:\\${t1}(?<code>\\d+)m|\\${M1}(?<uri>.*)${H1})`).exec(G.slice(z).join(""))||{groups:{}};if(W.code!==void 0){let V=Number.parseFloat(W.code);X=V===rb?void 0:V}else W.uri!==void 0&&(x=W.uri.length===0?void 0:W.uri)}let B=pb.codes.get(Number(X));G[z+1]===`
`?(x&&(Q+=p1("")),X&&B&&(Q+=u1(B))):J===`
`&&(X&&B&&(Q+=u1(X)),x&&(Q+=p1(x)))}return Q};function r1($,K,Y){return String($).normalize().replace(/\r\n/g,`
`).split(`
`).map((Q)=>lb(Q,K,Y)).join(`
`)}var nb=["up","down","left","right","space","enter","cancel"],t={actions:new Set(nb),aliases:new Map([["k","up"],["j","down"],["h","left"],["l","right"],["\x03","cancel"],["escape","cancel"]])};function O1($,K){if(typeof $=="string")return t.aliases.get($)===K;for(let Y of $)if(Y!==void 0&&O1(Y,K))return!0;return!1}function ib($,K){if($===K)return;let Y=$.split(`
`),Q=K.split(`
`),X=[];for(let x=0;x<Math.max(Y.length,Q.length);x++)Y[x]!==Q[x]&&X.push(x);return X}var ab=globalThis.process.platform.startsWith("win"),V1=Symbol("clack:cancel");function k($){return $===V1}function a($,K){let Y=$;Y.isTTY&&Y.setRawMode(K)}function e1({input:$=h1,output:K=D1,overwrite:Y=!0,hideCursor:Q=!0}={}){let X=m.createInterface({input:$,output:K,prompt:"",tabSize:1});m.emitKeypressEvents($,X),$.isTTY&&$.setRawMode(!0);let x=(b,{name:Z,sequence:G})=>{let z=String(b);if(O1([z,Z,G],"cancel")){Q&&K.write(_.cursor.show),process.exit(0);return}if(!Y)return;m.moveCursor(K,Z==="return"?0:-1,Z==="return"?-1:0,()=>{m.clearLine(K,1,()=>{$.once("keypress",x)})})};return Q&&K.write(_.cursor.hide),$.once("keypress",x),()=>{$.off("keypress",x),Q&&K.write(_.cursor.show),$.isTTY&&!ab&&$.setRawMode(!1),X.terminal=!1,X.close()}}var tb=Object.defineProperty,sb=($,K,Y)=>(K in $)?tb($,K,{enumerable:!0,configurable:!0,writable:!0,value:Y}):$[K]=Y,R=($,K,Y)=>(sb($,typeof K!="symbol"?K+"":K,Y),Y);class e{constructor($,K=!0){R(this,"input"),R(this,"output"),R(this,"_abortSignal"),R(this,"rl"),R(this,"opts"),R(this,"_render"),R(this,"_track",!1),R(this,"_prevFrame",""),R(this,"_subscribers",new Map),R(this,"_cursor",0),R(this,"state","initial"),R(this,"error",""),R(this,"value");let{input:Y=h1,output:Q=D1,render:X,signal:x,...b}=$;this.opts=b,this.onKeypress=this.onKeypress.bind(this),this.close=this.close.bind(this),this.render=this.render.bind(this),this._render=X.bind(this),this._track=K,this._abortSignal=x,this.input=Y,this.output=Q}unsubscribe(){this._subscribers.clear()}setSubscriber($,K){let Y=this._subscribers.get($)??[];Y.push(K),this._subscribers.set($,Y)}on($,K){this.setSubscriber($,{cb:K})}once($,K){this.setSubscriber($,{cb:K,once:!0})}emit($,...K){let Y=this._subscribers.get($)??[],Q=[];for(let X of Y)X.cb(...K),X.once&&Q.push(()=>Y.splice(Y.indexOf(X),1));for(let X of Q)X()}prompt(){return new Promise(($,K)=>{if(this._abortSignal){if(this._abortSignal.aborted)return this.state="cancel",this.close(),$(V1);this._abortSignal.addEventListener("abort",()=>{this.state="cancel",this.close()},{once:!0})}let Y=new Cb(0);Y._write=(Q,X,x)=>{this._track&&(this.value=this.rl?.line.replace(/\t/g,""),this._cursor=this.rl?.cursor??0,this.emit("value",this.value)),x()},this.input.pipe(Y),this.rl=F1.createInterface({input:this.input,output:Y,tabSize:2,prompt:"",escapeCodeTimeout:50}),F1.emitKeypressEvents(this.input,this.rl),this.rl.prompt(),this.opts.initialValue!==void 0&&this._track&&this.rl.write(this.opts.initialValue),this.input.on("keypress",this.onKeypress),a(this.input,!0),this.output.on("resize",this.render),this.render(),this.once("submit",()=>{this.output.write(_.cursor.show),this.output.off("resize",this.render),a(this.input,!1),$(this.value)}),this.once("cancel",()=>{this.output.write(_.cursor.show),this.output.off("resize",this.render),a(this.input,!1),$(V1)})})}onKeypress($,K){if(this.state==="error"&&(this.state="active"),K?.name&&(!this._track&&t.aliases.has(K.name)&&this.emit("cursor",t.aliases.get(K.name)),t.actions.has(K.name)&&this.emit("cursor",K.name)),$&&($.toLowerCase()==="y"||$.toLowerCase()==="n")&&this.emit("confirm",$.toLowerCase()==="y"),$==="\t"&&this.opts.placeholder&&(this.value||(this.rl?.write(this.opts.placeholder),this.emit("value",this.opts.placeholder))),$&&this.emit("key",$.toLowerCase()),K?.name==="return"){if(this.opts.validate){let Y=this.opts.validate(this.value);Y&&(this.error=Y instanceof Error?Y.message:Y,this.state="error",this.rl?.write(this.value))}this.state!=="error"&&(this.state="submit")}O1([$,K?.name,K?.sequence],"cancel")&&(this.state="cancel"),(this.state==="submit"||this.state==="cancel")&&this.emit("finalize"),this.render(),(this.state==="submit"||this.state==="cancel")&&this.close()}close(){this.input.unpipe(),this.input.removeListener("keypress",this.onKeypress),this.output.write(`
`),a(this.input,!1),this.rl?.close(),this.rl=void 0,this.emit(`${this.state}`,this.value),this.unsubscribe()}restoreCursor(){let $=r1(this._prevFrame,process.stdout.columns,{hard:!0}).split(`
`).length-1;this.output.write(_.cursor.move(-999,$*-1))}render(){let $=r1(this._render(this)??"",process.stdout.columns,{hard:!0});if($!==this._prevFrame){if(this.state==="initial")this.output.write(_.cursor.hide);else{let K=ib(this._prevFrame,$);if(this.restoreCursor(),K&&K?.length===1){let Y=K[0];this.output.write(_.cursor.move(0,Y)),this.output.write(_.erase.lines(1));let Q=$.split(`
`);this.output.write(Q[Y]),this._prevFrame=$,this.output.write(_.cursor.move(0,Q.length-Y-1));return}if(K&&K?.length>1){let Y=K[0];this.output.write(_.cursor.move(0,Y)),this.output.write(_.erase.down());let Q=$.split(`
`).slice(Y);this.output.write(Q.join(`
`)),this._prevFrame=$;return}this.output.write(_.erase.down())}this.output.write($),this.state==="initial"&&(this.state="active"),this._prevFrame=$}}}class A1 extends e{get cursor(){return this.value?0:1}get _value(){return this.cursor===0}constructor($){super($,!1),this.value=!!$.initialValue,this.on("value",()=>{this.value=this._value}),this.on("confirm",(K)=>{this.output.write(_.cursor.move(0,-1)),this.value=K,this.state="submit",this.close()}),this.on("cursor",()=>{this.value=!this.value})}}var eb=Object.defineProperty,b9=($,K,Y)=>(K in $)?eb($,K,{enumerable:!0,configurable:!0,writable:!0,value:Y}):$[K]=Y,o1=($,K,Y)=>(b9($,typeof K!="symbol"?K+"":K,Y),Y);class T1 extends e{constructor($){super($,!1),o1(this,"options"),o1(this,"cursor",0),this.options=$.options,this.cursor=this.options.findIndex(({value:K})=>K===$.initialValue),this.cursor===-1&&(this.cursor=0),this.changeValue(),this.on("cursor",(K)=>{switch(K){case"left":case"up":this.cursor=this.cursor===0?this.options.length-1:this.cursor-1;break;case"down":case"right":this.cursor=this.cursor===this.options.length-1?0:this.cursor+1;break}this.changeValue()})}get _value(){return this.options[this.cursor]}changeValue(){this.value=this._value.value}}class P1 extends e{get valueWithCursor(){if(this.state==="submit")return this.value;if(this.cursor>=this.value.length)return`${this.value}\u2588`;let $=this.value.slice(0,this.cursor),[K,...Y]=this.value.slice(this.cursor);return`${$}${l1.default.inverse(K)}${Y.join("")}`}get cursor(){return this._cursor}constructor($){super($),this.on("finalize",()=>{this.value||(this.value=$.defaultValue)})}}var q=l(W1(),1),b1=l(B1(),1);import y from"process";function $9(){return y.platform!=="win32"?y.env.TERM!=="linux":!!y.env.CI||!!y.env.WT_SESSION||!!y.env.TERMINUS_SUBLIME||y.env.ConEmuTask==="{cmd::Cmder}"||y.env.TERM_PROGRAM==="Terminus-Sublime"||y.env.TERM_PROGRAM==="vscode"||y.env.TERM==="xterm-256color"||y.env.TERM==="alacritty"||y.env.TERMINAL_EMULATOR==="JetBrains-JediTerm"}var I1=$9(),S=($,K)=>I1?$:K,K9=S("\u25C6","*"),$b=S("\u25A0","x"),Kb=S("\u25B2","x"),$1=S("\u25C7","o"),Y9=S("\u250C","T"),T=S("\u2502","|"),g=S("\u2514","\u2014"),L1=S("\u25CF",">"),U1=S("\u25CB"," "),X4=S("\u25FB","[\u2022]"),x4=S("\u25FC","[+]"),Z4=S("\u25FB","[ ]"),q4=S("\u25AA","\u2022"),bb=S("\u2500","-"),Q9=S("\u256E","+"),X9=S("\u251C","+"),x9=S("\u256F","+"),Z9=S("\u25CF","\u2022"),q9=S("\u25C6","*"),B9=S("\u25B2","!"),J9=S("\u25A0","x"),_1=($)=>{switch($){case"initial":case"active":return q.default.cyan(K9);case"cancel":return q.default.red($b);case"error":return q.default.yellow(Kb);case"submit":return q.default.green($1)}},W9=($)=>{let{cursor:K,options:Y,style:Q}=$,X=$.maxItems??Number.POSITIVE_INFINITY,x=Math.max(process.stdout.rows-4,0),b=Math.min(x,Math.max(X,5)),Z=0;K>=Z+b-3?Z=Math.max(Math.min(K-b+3,Y.length-b),0):K<Z+2&&(Z=Math.max(K-2,0));let G=b<Y.length&&Z>0,z=b<Y.length&&Z+b<Y.length;return Y.slice(Z,Z+b).map((J,B,W)=>{let V=B===0&&G,M=B===W.length-1&&z;return V||M?q.default.dim("..."):Q(J,B+Z===K)})},c=($)=>new P1({validate:$.validate,placeholder:$.placeholder,defaultValue:$.defaultValue,initialValue:$.initialValue,render(){let K=`${q.default.gray(T)}
${_1(this.state)}  ${$.message}
`,Y=$.placeholder?q.default.inverse($.placeholder[0])+q.default.dim($.placeholder.slice(1)):q.default.inverse(q.default.hidden("_")),Q=this.value?this.valueWithCursor:Y;switch(this.state){case"error":return`${K.trim()}
${q.default.yellow(T)}  ${Q}
${q.default.yellow(g)}  ${q.default.yellow(this.error)}
`;case"submit":return`${K}${q.default.gray(T)}  ${q.default.dim(this.value||$.placeholder)}`;case"cancel":return`${K}${q.default.gray(T)}  ${q.default.strikethrough(q.default.dim(this.value??""))}${this.value?.trim()?`
${q.default.gray(T)}`:""}`;default:return`${K}${q.default.cyan(T)}  ${Q}
${q.default.cyan(g)}
`}}}).prompt();var w=($)=>{let K=$.active??"Yes",Y=$.inactive??"No";return new A1({active:K,inactive:Y,initialValue:$.initialValue??!0,render(){let Q=`${q.default.gray(T)}
${_1(this.state)}  ${$.message}
`,X=this.value?K:Y;switch(this.state){case"submit":return`${Q}${q.default.gray(T)}  ${q.default.dim(X)}`;case"cancel":return`${Q}${q.default.gray(T)}  ${q.default.strikethrough(q.default.dim(X))}
${q.default.gray(T)}`;default:return`${Q}${q.default.cyan(T)}  ${this.value?`${q.default.green(L1)} ${K}`:`${q.default.dim(U1)} ${q.default.dim(K)}`} ${q.default.dim("/")} ${this.value?`${q.default.dim(U1)} ${q.default.dim(Y)}`:`${q.default.green(L1)} ${Y}`}
${q.default.cyan(g)}
`}}}).prompt()},r=($)=>{let K=(Y,Q)=>{let X=Y.label??String(Y.value);switch(Q){case"selected":return`${q.default.dim(X)}`;case"active":return`${q.default.green(L1)} ${X} ${Y.hint?q.default.dim(`(${Y.hint})`):""}`;case"cancelled":return`${q.default.strikethrough(q.default.dim(X))}`;default:return`${q.default.dim(U1)} ${q.default.dim(X)}`}};return new T1({options:$.options,initialValue:$.initialValue,render(){let Y=`${q.default.gray(T)}
${_1(this.state)}  ${$.message}
`;switch(this.state){case"submit":return`${Y}${q.default.gray(T)}  ${K(this.options[this.cursor],"selected")}`;case"cancel":return`${Y}${q.default.gray(T)}  ${K(this.options[this.cursor],"cancelled")}
${q.default.gray(T)}`;default:return`${Y}${q.default.cyan(T)}  ${W9({cursor:this.cursor,options:this.options,maxItems:$.maxItems,style:(Q,X)=>K(Q,X?"active":"inactive")}).join(`
${q.default.cyan(T)}  `)}
${q.default.cyan(g)}
`}}}).prompt()};var E=($="",K="")=>{let Y=`
${$}
`.split(`
`),Q=S1(K).length,X=Math.max(Y.reduce((b,Z)=>{let G=S1(Z);return G.length>b?G.length:b},0),Q)+2,x=Y.map((b)=>`${q.default.gray(T)}  ${q.default.dim(b)}${" ".repeat(X-S1(b).length)}${q.default.gray(T)}`).join(`
`);process.stdout.write(`${q.default.gray(T)}
${q.default.green($1)}  ${q.default.reset(K)} ${q.default.gray(bb.repeat(Math.max(X-Q-1,1))+Q9)}
${x}
${q.default.gray(X9+bb.repeat(X+2)+x9)}
`)},f=($="")=>{process.stdout.write(`${q.default.gray(g)}  ${q.default.red($)}

`)},o=($="")=>{process.stdout.write(`${q.default.gray(Y9)}  ${$}
`)},h=($="")=>{process.stdout.write(`${q.default.gray(T)}
${q.default.gray(g)}  ${$}

`)},U={message:($="",{symbol:K=q.default.gray(T)}={})=>{let Y=[`${q.default.gray(T)}`];if($){let[Q,...X]=$.split(`
`);Y.push(`${K}  ${Q}`,...X.map((x)=>`${q.default.gray(T)}  ${x}`))}process.stdout.write(`${Y.join(`
`)}
`)},info:($)=>{U.message($,{symbol:q.default.blue(Z9)})},success:($)=>{U.message($,{symbol:q.default.green(q9)})},step:($)=>{U.message($,{symbol:q.default.green($1)})},warn:($)=>{U.message($,{symbol:q.default.yellow(B9)})},warning:($)=>{U.warn($)},error:($)=>{U.message($,{symbol:q.default.red(J9)})}},Yb=()=>{let $=I1?["\u25D2","\u25D0","\u25D3","\u25D1"]:["\u2022","o","O","0"],K=I1?80:120,Y=process.env.CI==="true",Q,X,x=!1,b="",Z,G=(H)=>{let L=H>1?"Something went wrong":"Canceled";x&&j(L,H)},z=()=>G(2),J=()=>G(1),B=()=>{process.on("uncaughtExceptionMonitor",z),process.on("unhandledRejection",z),process.on("SIGINT",J),process.on("SIGTERM",J),process.on("exit",G)},W=()=>{process.removeListener("uncaughtExceptionMonitor",z),process.removeListener("unhandledRejection",z),process.removeListener("SIGINT",J),process.removeListener("SIGTERM",J),process.removeListener("exit",G)},V=()=>{if(Z===void 0)return;Y&&process.stdout.write(`
`);let H=Z.split(`
`);process.stdout.write(b1.cursor.move(-999,H.length-1)),process.stdout.write(b1.erase.down(H.length))},M=(H)=>H.replace(/\.+$/,""),N=(H="")=>{x=!0,Q=e1(),b=M(H),process.stdout.write(`${q.default.gray(T)}
`);let L=0,O=0;B(),X=setInterval(()=>{if(Y&&b===Z)return;V(),Z=b;let d=q.default.magenta($[L]),Ib=Y?"...":".".repeat(Math.floor(O)).slice(0,3);process.stdout.write(`${d}  ${b}${Ib}`),L=L+1<$.length?L+1:0,O=O<$.length?O+0.125:0},K)},j=(H="",L=0)=>{x=!1,clearInterval(X),V();let O=L===0?q.default.green($1):L===1?q.default.red($b):q.default.red(Kb);b=M(H??b),process.stdout.write(`${O}  ${b}
`),W(),Q()};return{start:N,stop:j,message:(H="")=>{b=M(H??b)}}},N1=async($,K)=>{let Y={},Q=Object.keys($);for(let X of Q){let x=$[X],b=await x({results:Y})?.catch((Z)=>{throw Z});if(typeof K?.onCancel=="function"&&k(b)){Y[X]="canceled",K.onCancel({results:Y});continue}Y[X]=b}return Y};import{readFile as R1,writeFile as u,mkdir as Z1,access as F}from"fs/promises";import{execSync as Zb,exec as G9}from"child_process";import{createHash as V9,randomBytes as H9}from"crypto";import{homedir as M9}from"os";import{join as A,basename as qb,dirname as Y1}from"path";var C="0.1.0",Bb=process.env.SEED_DIR||Y1(process.argv[1]),O9="https://raw.githubusercontent.com/seed-hypermedia/seed/main",k1=process.env.SEED_DEPLOY_URL||(process.env.SEED_REPO_URL?`${process.env.SEED_REPO_URL}/ops`:`${O9}/ops`),Jb=`${k1}/docker-compose.yml`,A9="https://notify.seed.hyper.media",T9="https://ln.seed.hyper.media",P9="https://ln.testnet.seed.hyper.media";function S9($=Bb){return{seedDir:$,configPath:A($,"config.json"),composePath:A($,"docker-compose.yml"),deployLog:A($,"deploy.log")}}function I9(){return{run($){return Zb($,{encoding:"utf-8",timeout:30000}).trim()},runSafe($){try{return this.run($)}catch{return null}},exec($){return new Promise((K,Y)=>{G9($,{timeout:120000},(Q,X,x)=>{if(Q)Y(Q);else K({stdout:X.toString().trim(),stderr:x.toString().trim()})})})}}}function Wb($){switch($){case"dev":return{testnet:!0,release_channel:"dev"};case"staging":return{testnet:!1,release_channel:"dev"};case"prod":default:return{testnet:!1,release_channel:"latest"}}}async function D($){try{return await F($.configPath),!0}catch{return!1}}async function v($){let K=await R1($.configPath,"utf-8");return JSON.parse(K)}async function Q1($,K){await Z1(K.seedDir,{recursive:!0}),await u(K.configPath,JSON.stringify($,null,2)+`
`,"utf-8")}function zb($=10){let Y=H9($);return Array.from(Y).map((Q)=>"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[Q%62]).join("")}function I($){let K=new Date().toISOString();if(!process.stdout.isTTY)console.log(`[${K}] ${$}`)}var X1=`
Run 'seed-deploy' to resume installation at any time.
`,x1="Manage your node anytime with the 'seed-deploy' command. Run 'seed-deploy --help' for options.";function L9($){if($.testnet)return"dev";if($.imageTag==="dev")return"staging";return"prod"}function U9($){let K=null,Y=!1;try{let Q=JSON.parse($);for(let X of Q){if(X.startsWith("SEED_LOG_LEVEL="))K=X.split("=")[1];if(X.startsWith("SEED_P2P_TESTNET_NAME=")&&X.split("=")[1])Y=!0}}catch{}return{logLevel:K,testnet:Y}}function _9($){let K=null,Y=!1,Q=!1;try{let X=JSON.parse($);for(let x of X){if(x.startsWith("SEED_BASE_URL="))K=x.split("=")[1];if(x.startsWith("SEED_IS_GATEWAY=true"))Y=!0;if(x.startsWith("SEED_ENABLE_STATISTICS=true"))Q=!0}}catch{}return{hostname:K,gateway:Y,trafficStats:Q}}function N9($){let K=$.split(":");return K.length>1?K[K.length-1]:"latest"}async function j9($){let K=M9(),Y=[A(K,".seed-site"),"/shm/gateway","/shm"],Q=null;for(let H of Y)try{await F(H),Q=H;break}catch{}let X=$.runSafe("docker ps --format '{{.Names}}' 2>/dev/null | grep -q seed");if(!Q&&X===null)return null;if(!Q)Q=A(K,".seed-site");let x=null,b=!1,Z=[A(Q,"web","config.json"),"/shm/gateway/web/config.json",A(K,".seed-site","web","config.json")];for(let H of Z)try{let L=await R1(H,"utf-8"),O=JSON.parse(L);if(O.availableRegistrationSecret){x=O.availableRegistrationSecret;break}if(O.registeredAccountUid||O.sourcePeerId)b=!0}catch{}let G=null,z=null,J=null,B=!1,W=!1,V=!1,M=$.runSafe("docker inspect seed-daemon --format '{{json .Config.Env}}' 2>/dev/null");if(M){let H=U9(M);z=H.logLevel,B=H.testnet}let N=$.runSafe("docker inspect seed-web --format '{{json .Config.Env}}' 2>/dev/null");if(N){let H=_9(N);G=H.hostname,W=H.gateway,V=H.trafficStats}let j=$.runSafe("docker inspect seed-web --format '{{.Config.Image}}' 2>/dev/null");if(j)J=N9(j);return{workspace:Q,secret:x,secretConsumed:b,hostname:G,logLevel:z,imageTag:J,testnet:B,gateway:W,trafficStats:V}}async function Gb($,K,Y){o(`Seed Node Migration v${C}`),E([`Detected an existing Seed installation at: ${$.workspace}`,"","We'll import your current settings and migrate to the new deployment system.",`After migration, your node will be managed from ${K.seedDir}/ and updated via cron.`,"","Please review and confirm the detected values below."].join(`
`),"Existing installation found");let Q=await N1({domain:()=>c({message:"Public hostname (including https://)",placeholder:$.hostname||"https://node1.seed.run",validate:(M)=>{if(!M)return"Required";if(!M.startsWith("https://")&&!M.startsWith("http://"))return"Must start with https:// or http://"}}),environment:()=>r({message:"Environment",initialValue:L9($),options:[{value:"prod",label:"Production",hint:"stable releases, mainnet network \u2014 recommended"},{value:"staging",label:"Staging",hint:"development builds, mainnet network \u2014 for testing"},{value:"dev",label:"Development",hint:"development builds, testnet network"}]}),log_level:()=>r({message:"Log level",initialValue:$.logLevel??"info",options:[{value:"debug",label:"Debug",hint:"verbose, useful for troubleshooting"},{value:"info",label:"Info",hint:"standard operational logging"},{value:"warn",label:"Warn",hint:"only warnings and errors"},{value:"error",label:"Error",hint:"only errors"}]}),gateway:()=>w({message:"Run as public gateway?",initialValue:$.gateway}),analytics:()=>w({message:"Enable web analytics? Adds a Plausible.io dashboard to track your site's traffic.",initialValue:$.trafficStats}),email:()=>c({message:"Contact email (optional) \u2014 lets us notify you about security updates. Not shared publicly.",placeholder:"you@example.com",validate:(M)=>{if(M&&!M.includes("@"))return"Must be a valid email"}})},{onCancel:()=>{f("Migration cancelled."),console.log(X1),process.exit(0)}}),X=$.secret??zb();if($.secret)U.success("Registration secret imported from existing installation.");else if($.secretConsumed)U.info("Node is already registered (secret was consumed). Generated a new secret for future registrations.");else U.warn("No existing registration secret found. Generated a new one.");let x=Q.environment,b=Wb(x),Z={domain:Q.domain,email:Q.email||"",compose_url:Jb,compose_sha:"",compose_envs:{LOG_LEVEL:Q.log_level},environment:x,release_channel:b.release_channel,testnet:b.testnet,link_secret:X,analytics:Q.analytics,gateway:Q.gateway,last_script_run:""},G=Object.entries(Z).map(([M,N])=>`  ${M}: ${typeof N==="object"?JSON.stringify(N):N}`).join(`
`);E(G,"Configuration summary");let z=await w({message:"Write config and proceed with deployment?"});if(k(z)||!z)f("Migration cancelled."),console.log(X1),process.exit(0);await Q1(Z,K),U.success(`Config written to ${K.configPath}`);let J=A($.workspace,"web"),B=String(process.getuid()),W=String(process.getgid()),V=Y.runSafe(`stat -c '%u:%g' "${J}" 2>/dev/null`);if(V&&V!==`${B}:${W}`){if(U.warn(`The web data directory (${J}) is owned by a different user (${V}). Updating ownership so the web container can write to it.`),!Y.runSafe(`chown -R ${B}:${W} "${J}" 2>/dev/null`))Y.runSafe(`sudo chown -R ${B}:${W} "${J}"`);U.success("File ownership updated.")}return Z}async function Qb($,K){let Y=!!K;if(o(Y?`Seed Node Reconfiguration v${C}`:`Seed Node Setup v${C}`),!Y)E(["Welcome! This wizard will configure your new Seed node.","","Seed is a peer-to-peer hypermedia publishing system. This script sets up","the Docker containers, reverse proxy, and networking so your node is","reachable on the public internet.","",`Configuration will be saved to ${$.configPath}.`,"Subsequent runs of this script will deploy automatically (headless mode)."].join(`
`),"First-time setup");else E(["Editing your current configuration. Press Tab to keep existing values, or type to change them.","",`Configuration: ${$.configPath}`].join(`
`),"Reconfiguration");let Q=await N1({domain:()=>c({message:"Public hostname (including https://)",placeholder:K?.domain||"https://node1.seed.run",validate:(W)=>{if(!W)return"Required";if(!W.startsWith("https://")&&!W.startsWith("http://"))return"Must start with https:// or http://"}}),environment:()=>r({message:"Environment",initialValue:K?.environment??"prod",options:[{value:"prod",label:"Production",hint:"stable releases, mainnet network \u2014 recommended"},{value:"staging",label:"Staging",hint:"development builds, mainnet network \u2014 for testing"},{value:"dev",label:"Development",hint:"development builds, testnet network"}]}),log_level:()=>r({message:"Log level for Seed services",initialValue:K?.compose_envs?.LOG_LEVEL??"info",options:[{value:"debug",label:"Debug",hint:"very verbose, useful for troubleshooting"},{value:"info",label:"Info",hint:"standard operational logging \u2014 recommended"},{value:"warn",label:"Warn",hint:"only warnings and errors"},{value:"error",label:"Error",hint:"only critical errors"}]}),gateway:()=>w({message:"Run as a public gateway? (serves all known public content)",initialValue:K?.gateway??!1}),analytics:()=>w({message:"Enable web analytics? Adds a Plausible.io dashboard to track your site's traffic.",initialValue:K?.analytics??!1}),email:()=>c({message:"Contact email (optional) \u2014 lets us notify you about security updates. Not shared publicly.",placeholder:K?.email||"you@example.com",validate:(W)=>{if(W&&!W.includes("@"))return"Must be a valid email"}})},{onCancel:()=>{f(Y?"Reconfiguration cancelled.":"Setup cancelled."),console.log(X1),process.exit(0)}}),X=K?.link_secret??zb(),x=Q.environment,b=Wb(x),Z={domain:Q.domain,email:Q.email||"",compose_url:Jb,compose_sha:K?.compose_sha??"",compose_envs:{LOG_LEVEL:Q.log_level},environment:x,release_channel:b.release_channel,testnet:b.testnet,link_secret:X,analytics:Q.analytics,gateway:Q.gateway,last_script_run:K?.last_script_run??""},G=[["domain",Z.domain],["email",Z.email],["environment",Z.environment],["log_level",Z.compose_envs.LOG_LEVEL],["gateway",String(Z.gateway)],["analytics",String(Z.analytics)]],z=K?{domain:K.domain,email:K.email,environment:K.environment,log_level:K.compose_envs?.LOG_LEVEL??"info",gateway:String(K.gateway),analytics:String(K.analytics)}:void 0,J=G.map(([W,V])=>{if(z&&String(V)!==String(z[W]??""))return`  \u270E ${W}: ${V}`;return`    ${W}: ${V}`}).join(`
`);E(J,"Configuration summary");let B=await w({message:Y?"Save changes and redeploy?":"Write config and proceed with deployment?"});if(k(B)||!B)f(Y?"Reconfiguration cancelled.":"Setup cancelled."),console.log(X1),process.exit(0);return await Q1(Z,$),U.success(`Config written to ${$.configPath}`),Z}function Vb($){return $.replace(/^https?:\/\//,"").replace(/\/+$/,"")}function R9($){return`{$SEED_SITE_HOSTNAME}

encode zstd gzip

@ipfsget {
	method GET HEAD OPTIONS
	path /ipfs/*
}

reverse_proxy /.metrics* grafana:{$SEED_SITE_MONITORING_PORT:3001}

reverse_proxy @ipfsget seed-daemon:{$HM_SITE_BACKEND_GRPCWEB_PORT:56001}

reverse_proxy * seed-web:{$SEED_SITE_LOCAL_PORT:3000}
`}function j1($){return V9("sha256").update($).digest("hex")}async function Xb($){let K=["seed-proxy","seed-web","seed-daemon"];for(let Y of K)if($.runSafe(`docker inspect ${Y} --format '{{.State.Running}}' 2>/dev/null`)!=="true")return!1;return!0}async function k9($){let K=new Map,Y=["seed-proxy","seed-web","seed-daemon"];for(let Q of Y){let X=$.runSafe(`docker inspect ${Q} --format '{{.Image}}' 2>/dev/null`);if(X)K.set(Q,X)}return K}function y1($,K){let Y=Vb($.domain),Q=$.testnet?"dev":"",X=$.testnet?P9:T9,x={SEED_SITE_HOSTNAME:$.domain,SEED_SITE_DNS:Y,SEED_SITE_TAG:$.release_channel,SEED_SITE_WORKSPACE:K.seedDir,SEED_UID:String(process.getuid()),SEED_GID:String(process.getgid()),SEED_LOG_LEVEL:$.compose_envs.LOG_LEVEL,SEED_IS_GATEWAY:String($.gateway),SEED_ENABLE_STATISTICS:String($.analytics),SEED_P2P_TESTNET_NAME:Q,SEED_LIGHTNING_URL:X,NOTIFY_SERVICE_HOST:A9,SEED_SITE_MONITORING_WORKDIR:A(K.seedDir,"monitoring")};return Object.entries(x).map(([b,Z])=>`${b}="${Z}"`).join(" ")}function y9($){return[A($.seedDir,"proxy"),A($.seedDir,"proxy","data"),A($.seedDir,"proxy","config"),A($.seedDir,"web"),A($.seedDir,"daemon"),A($.seedDir,"monitoring"),A($.seedDir,"monitoring","grafana"),A($.seedDir,"monitoring","prometheus")]}async function w1($,K){try{await F($.seedDir)}catch{try{await Z1($.seedDir,{recursive:!0})}catch{I(`Creating ${$.seedDir} requires elevated permissions`),K.run(`sudo mkdir -p "${$.seedDir}"`),K.run(`sudo chown "$(id -u):$(id -g)" "${$.seedDir}"`)}}}async function xb($,K,Y,Q){I("Deployment failed \u2014 rolling back to previous images...");for(let[x,b]of $)I(`  Restoring ${x} to image ${b.slice(0,16)}...`),Q.runSafe(`docker stop ${x} 2>/dev/null`),Q.runSafe(`docker rm ${x} 2>/dev/null`);I("  Running docker compose up with cached images...");let X=y1(K,Y);Q.runSafe(`${X} docker compose -f ${Y.composePath} up -d --quiet-pull 2>&1`),I("Rollback complete. Check container status with: docker ps")}async function w9($){let K=process.argv[1],Y=`${k1}/dist/deploy.js`;try{let Q=await fetch(Y);if(!Q.ok){I(`Self-update: failed to fetch ${Y}: ${Q.status}`);return}let X=await Q.text(),x="";try{x=await R1(K,"utf-8")}catch{}if(j1(X)!==j1(x))await u(K,X,"utf-8"),I("Self-update: deploy.js updated (takes effect on next run).");else I("Self-update: deploy.js is up to date.")}catch(Q){I(`Self-update: skipped (${Q})`)}}async function K1($,K,Y){let Q=process.stdout.isTTY,X=Q?Yb():null,x=(O)=>{if(X)X.message(O);I(O)};if(Q)U.step("Starting deployment...");X?.start("Fetching docker-compose.yml..."),x("Fetching docker-compose.yml...");let Z=process.env.SEED_DEPLOY_URL||process.env.SEED_REPO_URL?`${k1}/docker-compose.yml`:$.compose_url,G=await fetch(Z);if(!G.ok)throw X?.stop("Failed to fetch docker-compose.yml"),Error(`Failed to fetch compose file from ${Z}: ${G.status}`);let z=await G.text(),J=j1(z),B=await Xb(Y);if($.compose_sha===J&&B){if(X?.stop("No changes detected \u2014 all containers healthy. Skipping redeployment."),I("No changes detected \u2014 compose SHA matches and containers are healthy. Skipping."),Q)console.log(`
  To change your node's configuration, run 'seed-deploy deploy --reconfigure'.
`);$.last_script_run=new Date().toISOString(),await Q1($,K);return}if($.compose_sha&&$.compose_sha!==J)x(`Compose file changed: ${$.compose_sha.slice(0,8)} -> ${J.slice(0,8)}`);await w1(K,Y),await u(K.composePath,z,"utf-8"),x("Setting up workspace directories...");let W=y9(K);for(let O of W)await Z1(O,{recursive:!0});x("Generating Caddyfile...");let V=R9($);await u(A(K.seedDir,"proxy","CaddyFile"),V,"utf-8");let M=A(K.seedDir,"web","config.json"),N=!1;try{await F(M)}catch{N=!0,await u(M,JSON.stringify({availableRegistrationSecret:$.link_secret})+`
`,"utf-8"),x("Created initial web/config.json with registration secret.")}let j=await k9(Y),H=y1($,K);if(!$.compose_sha)x("Removing legacy containers..."),Y.runSafe("docker stop seed-site seed-daemon seed-web seed-proxy autoupdater grafana prometheus 2>/dev/null"),Y.runSafe("docker rm seed-site seed-daemon seed-web seed-proxy autoupdater grafana prometheus 2>/dev/null");x("Pulling latest images...");try{await Y.exec(`${H} docker compose -f ${K.composePath} pull --quiet`)}catch(O){I(`Image pull failed: ${O}`)}x("Recreating containers...");try{let O=`${H} docker compose -f ${K.composePath} up -d --quiet-pull`,d=await Y.exec(O);if(d.stderr)I(`compose stderr: ${d.stderr}`)}catch(O){if(X?.stop("docker compose up failed"),I(`docker compose up failed: ${O}`),j.size>0)await xb(j,$,K,Y);throw Error(`Deployment failed: ${O}`)}let L=!1;for(let O=0;O<10;O++)if(x(`Health check ${O+1}/10...`),await new Promise((d)=>setTimeout(d,3000)),L=await Xb(Y),L)break;if(!L){if(X?.stop("Health checks failed"),I("Health checks failed \u2014 containers not running after 30s"),j.size>0)await xb(j,$,K,Y);throw Error("Deployment failed: containers did not become healthy within 30 seconds")}if($.compose_sha=J,$.last_script_run=new Date().toISOString(),await Q1($,K),x("Cleaning up unused images..."),Y.runSafe('docker image prune -a -f --filter "until=1m" 2>/dev/null'),X?.stop("Deployment complete!"),I("Deployment complete."),Q)U.message(x1);if(Q&&N)E([`Your site is live at ${$.domain}`,"",`  Secret:  ${$.link_secret}`,"","Open the Seed desktop app and enter this secret to link","your publisher account to this site."].join(`
`),"Setup complete")}function Hb($,K,Y="/usr/local/bin/bun"){let Q=`0 2 * * * ${Y} ${A(K.seedDir,"deploy.js")} >> ${K.deployLog} 2>&1 # seed-deploy`,X='0 0,4,8,12,16,20 * * * docker image prune -a -f --filter "until=1h" # seed-cleanup';return[$.split(`
`).filter((b)=>!b.includes("# seed-deploy")&&!b.includes("# seed-cleanup")).join(`
`).trim(),Q,'0 0,4,8,12,16,20 * * * docker image prune -a -f --filter "until=1h" # seed-cleanup'].filter(Boolean).join(`
`)+`
`}async function Mb($,K){let Y=K.runSafe("which bun")??"/usr/local/bin/bun",Q=K.runSafe("crontab -l 2>/dev/null")??"",X=Hb(Q,$,Y);try{if(K.run(`echo '${X}' | crontab -`),Q.includes("# seed-deploy")||Q.includes("# seed-cleanup"))I("Updated existing seed cron jobs.");else I("Installed nightly deployment cron job (02:00) and image cleanup cron.")}catch(x){I(`Warning: Failed to install cron job: ${x}`)}}var C9=["deploy","stop","start","restart","status","config","logs","cron","backup","restore","uninstall"];function E9($=process.argv){let K=$.slice(2),Y=K[0]??"deploy";if(Y==="--help"||Y==="-h")return{command:"help",args:[]};if(Y==="--version"||Y==="-v")return{command:"version",args:[]};if(Y==="--reconfigure")return{command:"deploy",args:[],reconfigure:!0};if(C9.includes(Y)){let Q=K.slice(1),X=Y==="deploy"&&Q.includes("--reconfigure"),x=X?Q.filter((b)=>b!=="--reconfigure"):Q;return{command:Y,args:x,reconfigure:X}}console.error(`Unknown command: ${Y}
`),Ob(),process.exit(1)}function Ob(){let $=`
Seed Node Deployment v${C}

Usage: seed-deploy [command] [options]

Commands:
  deploy      Deploy or update the Seed node (default)
  stop        Stop and remove all Seed containers
  start       Start containers without re-deploying
  restart     Restart all Seed containers
  status      Show node health, versions, and connectivity
  config      Print current configuration (secrets redacted)
  logs        Tail container logs [daemon|web|proxy]
  cron        Install or remove automatic update cron jobs
  backup      Create a portable backup of all node data
  restore     Restore node data from a backup file
  uninstall   Remove all Seed containers, data, and configuration

Options:
  --reconfigure  Re-run the setup wizard to change configuration
  -h, --help     Show this help message
  -v, --version  Show script version

Examples:
  seed-deploy                            Deploy or update
  seed-deploy deploy --reconfigure       Change node configuration
  seed-deploy stop                       Teardown containers
  seed-deploy status                     Check node health
  seed-deploy logs daemon                Tail seed-daemon logs
  seed-deploy cron                       Install automatic update cron
  seed-deploy cron remove                Remove cron jobs
  seed-deploy backup                     Create backup
  seed-deploy backup /tmp/backup.tar.gz  Create backup at custom path
  seed-deploy restore backup.tar.gz      Restore from backup file

The 'seed-deploy' command is installed at ~/.local/bin/seed-deploy
during initial setup. The deployment script lives at ${Bb}/deploy.js.
`.trimStart();console.log($)}async function m9($,K,Y=!1){if(await w1($,K),!process.stdout.isTTY)await w9($);if(await D($)){if(Y&&process.stdout.isTTY){let Z=await v($),G=await Qb($,Z);await K1(G,$,K),h(`Reconfiguration complete! Your Seed node is running.
${x1}`);return}I(`Seed deploy v${C} \u2014 config found at ${$.configPath}, running headless.`);let b=await v($);await K1(b,$,K);return}let Q=await j9(K),X;if(Q)X=await Gb(Q,$,K);else X=await Qb($);let x=await w({message:"Install nightly cron job for automatic updates? (runs at 02:00)",initialValue:!0});if(!k(x)&&x)await Mb($,K),U.success("Cron job installed. Your node will auto-update nightly at 02:00.");await K1(X,$,K),h(`Setup complete! Your Seed node is running.
${x1}`)}async function Ab($,K){console.log("Stopping and removing Seed containers..."),K.runSafe(`docker compose -f "${$.composePath}" down`),console.log("All Seed containers stopped and removed.")}async function Tb($,K){if(!await D($))console.error(`No config found at ${$.configPath}. Run 'seed-deploy' first to set up.`),process.exit(1);let Y=await v($),Q=y1(Y,$);console.log("Starting Seed containers..."),K.run(`${Q} docker compose -f "${$.composePath}" up -d --quiet-pull`),console.log("Seed containers started.")}async function v9($,K){await Ab($,K),await Tb($,K)}async function f9($,K){console.log(`
Seed Node Status v${C}`),console.log("\u2501".repeat(40));let Y=null;if(await D($))Y=await v($),console.log(`
Configuration:`),console.log(`  Domain:      ${Y.domain}`),console.log(`  Environment: ${{prod:"Production",staging:"Staging",dev:"Development"}[Y.environment]}`),console.log(`  Channel:     ${Y.release_channel}`),console.log(`  Gateway:     ${Y.gateway?"Yes":"No"}`),console.log(`  Analytics:   ${Y.analytics?"Yes":"No"}`),console.log(`  Config:      ${$.configPath}`);else console.log(`
No config found at ${$.configPath}. Node is not set up.`);console.log(`
Containers:`);let Q=["seed-daemon","seed-web","seed-proxy"],X=!1;for(let B of Q){let W=K.runSafe(`docker inspect ${B} --format '{{.State.Status}}' 2>/dev/null`),V=K.runSafe(`docker inspect ${B} --format '{{.Config.Image}}' 2>/dev/null`),M=K.runSafe(`docker inspect ${B} --format '{{.State.StartedAt}}' 2>/dev/null`);if(W){if(console.log(`  ${W==="running"?"\u2714":"\u26A0"} ${B.padEnd(14)} ${(W??"").padEnd(10)} ${V??""}${M?`  (since ${M})`:""}`),W!=="running"){X=!0;let j=K.runSafe(`docker logs --tail 1 ${B} 2>&1`);if(j)console.log(`      \u2514 ${j.slice(0,120)}`)}}else console.log(`  \u2718 ${B.padEnd(14)} not found`)}if(X)console.log(`
  Tip: Check logs with 'seed-deploy logs daemon|web|proxy'`);let x=K.runSafe("docker inspect prometheus --format '{{.State.Status}}' 2>/dev/null"),b=K.runSafe("docker inspect grafana --format '{{.State.Status}}' 2>/dev/null");if(x||b){let B=A($.seedDir,"monitoring","prometheus","prometheus.yaml"),W=A($.seedDir,"monitoring","grafana","provisioning"),V=!0;console.log(`
Monitoring:`);try{await F(B),console.log("  \u2714 Prometheus config exported")}catch{V=!1,console.log("  \u26A0 Prometheus config not exported")}try{await F(W),console.log("  \u2714 Grafana provisioning exported")}catch{V=!1,console.log("  \u26A0 Grafana provisioning not exported")}if(!V)console.log(`
  Tip: This may indicate a permissions issue with the monitoring/ directory.`),console.log("        Run 'seed-deploy deploy' to attempt an automatic fix.")}if(Y){console.log(`
Health Checks:`);let B=Vb(Y.domain),W=K.runSafe(`curl -sSf -o /dev/null -w '%{http_code}' --max-time 10 "${Y.domain}" 2>/dev/null`);if(W&&W.startsWith("2"))console.log(`  \u2714 HTTPS          ${W} OK`);else if(W)console.log(`  \u26A0 HTTPS          ${W}`);else console.log("  \u26A0 HTTPS          unreachable");let V=K.runSafe("curl -s --max-time 5 ifconfig.me 2>/dev/null"),M=K.runSafe(`dig +short ${B} A 2>/dev/null | head -1`);if(V&&M)if(M.trim()===V.trim())console.log(`  \u2714 DNS            ${B} -> ${M} (matches public IP)`);else console.log(`  \u26A0 DNS            ${B} -> ${M} (public IP is ${V})`);else if(!M)console.log(`  \u26A0 DNS            ${B} does not resolve`);else console.log("  ? DNS            could not determine public IP");let N=K.runSafe(`echo | openssl s_client -servername "${B}" -connect "${B}:443" 2>/dev/null | openssl x509 -noout -enddate 2>/dev/null`);if(N){let j=N.replace("notAfter=",""),H=new Date(j),L=Math.floor((H.getTime()-Date.now())/86400000),O=L>14?"\u2714":"\u26A0";console.log(`  ${O} Certificate    valid, expires ${H.toISOString().slice(0,10)} (${L}d)`)}else console.log("  \u26A0 Certificate    could not check")}let Z=K.runSafe(`du -sh "${$.seedDir}" 2>/dev/null`);if(Z)console.log(`
Disk:`),console.log(`  ${$.seedDir}  ${Z.split("\t")[0]}`);let G=K.runSafe("crontab -l 2>/dev/null")??"",z=G.split(`
`).find((B)=>B.includes("# seed-deploy")),J=G.split(`
`).find((B)=>B.includes("# seed-cleanup"));if(console.log(`
Cron:`),console.log(`  Auto-update: ${z?z.split(" ").slice(0,5).join(" "):"not installed"}`),console.log(`  Cleanup:     ${J?J.split(" ").slice(0,5).join(" "):"not installed"}`),!z||!J)console.log(`
  Tip: Run 'seed-deploy cron' to set up automatic updates.`);console.log("")}async function F9($){if(!await D($))console.error(`No config found at ${$.configPath}. Run 'seed-deploy' first.`),process.exit(1);let Y={...await v($),link_secret:"****"};console.log(JSON.stringify(Y,null,2))}async function d9($,K){let Y=K[0],Q=Y?`seed-${Y}`:"";try{Zb(`docker compose -f "${$.composePath}" logs -f --tail 100 ${Q}`,{stdio:"inherit"})}catch{}}async function g9($,K,Y){let Q=Y[0]??"install";if(Q==="remove"){let X=K.runSafe("crontab -l 2>/dev/null")??"";if(!X.includes("# seed-deploy")&&!X.includes("# seed-cleanup")){console.log("No seed cron jobs found. Nothing to remove.");return}let x=Pb(X);try{K.run(`echo '${x}' | crontab -`),console.log("Seed cron jobs removed.")}catch(b){console.error(`Failed to remove cron jobs: ${b}`),process.exit(1)}return}if(Q==="install"){await Mb($,K);let X=K.runSafe("crontab -l 2>/dev/null")??"",x=X.split(`
`).find((Z)=>Z.includes("# seed-deploy")),b=X.split(`
`).find((Z)=>Z.includes("# seed-cleanup"));console.log("Cron jobs installed:"),console.log(`  Auto-update: ${x??"(missing)"}`),console.log(`  Cleanup:     ${b??"(missing)"}`);return}console.error(`Unknown cron subcommand: ${Q}`),console.error("Usage: seed-deploy cron [install|remove]"),process.exit(1)}function c9($){return $.split(`
`).filter((K)=>K.includes("# seed-deploy")||K.includes("# seed-cleanup"))}function Pb($){return $.split(`
`).filter((K)=>!K.includes("# seed-deploy")&&!K.includes("# seed-cleanup")).join(`
`).trim()+`
`}async function Sb($,K,Y){if(!await D($))console.error(`No config found at ${$.configPath}. Nothing to back up.`),process.exit(1);let Q=await v($),X=new Date().toISOString().replace(/[:.]/g,"-"),x=A($.seedDir,"backups",`seed-backup-${X}.tar.gz`),b=Y[0]||x,Z=Y1(b);await Z1(Z,{recursive:!0});let G=K.runSafe("crontab -l 2>/dev/null")??"",z={version:C,timestamp:new Date().toISOString(),hostname:Q.domain,seedDir:$.seedDir,cron:c9(G)};await u(A($.seedDir,"backup-meta.json"),JSON.stringify(z,null,2)+`
`,"utf-8"),console.log("Stopping containers for consistent backup..."),K.runSafe(`docker compose -f "${$.composePath}" stop`);let J=qb($.seedDir),B=Y1($.seedDir);try{K.run(`tar -czf "${b}" -C "${B}" --exclude="${J}/backups" --exclude="${J}/.env" --exclude="${J}/deploy.js" --exclude="${J}/deploy.log" "${J}/config.json" "${J}/backup-meta.json" "${J}/docker-compose.yml" "${J}/web" "${J}/daemon" "${J}/proxy"`)}catch(V){console.error(`Backup failed: ${V}`),K.runSafe(`docker compose -f "${$.composePath}" start`),process.exit(1)}K.runSafe(`rm -f "${A($.seedDir,"backup-meta.json")}"`),console.log("Restarting containers..."),K.runSafe(`docker compose -f "${$.composePath}" start`);let W=K.runSafe(`du -h "${b}"`)?.split("\t")[0]??"unknown";console.log(`
Backup created: ${b} (${W})`)}async function u9($,K,Y){let Q=Y[0];if(!Q)console.error("Usage: seed-deploy restore <backup-file.tar.gz>"),process.exit(1);try{await F(Q)}catch{console.error(`File not found: ${Q}`),process.exit(1)}let X=null,x=qb($.seedDir),b=K.runSafe(`tar -xzf "${Q}" -O "${x}/backup-meta.json" 2>/dev/null`);if(b)try{X=JSON.parse(b)}catch{}if(o(`Seed Node Restore v${C}`),X)E([`Created:  ${X.timestamp}`,`Source:   ${X.hostname}`,`Version:  ${X.version}`].join(`
`),"Restoring from backup");let Z=await w({message:`This will overwrite all data in ${$.seedDir}. Continue?`});if(k(Z)||!Z)f("Restore cancelled."),console.log(`
Run 'seed-deploy restore <file>' to try again.
`),process.exit(0);console.log("Stopping existing containers..."),K.runSafe(`docker compose -f "${$.composePath}" down`),console.log("Extracting backup..."),await w1($,K);let G=Y1($.seedDir);if(K.run(`tar -xzf "${Q}" -C "${G}"`),K.runSafe(`rm -f "${A($.seedDir,"backup-meta.json")}"`),X?.cron&&X.cron.length>0){let B=K.runSafe("crontab -l 2>/dev/null")??"",W=Hb(B,$);try{K.run(`echo '${W}' | crontab -`),console.log("Cron jobs restored.")}catch{console.log("Warning: Could not restore cron jobs.")}}let z=await w({message:"Would you like to review the configuration before deploying?",initialValue:!1}),J;if(!k(z)&&z){let B=await v($),W={workspace:$.seedDir,secret:B.link_secret,secretConsumed:!1,hostname:B.domain,logLevel:B.compose_envs.LOG_LEVEL,imageTag:B.release_channel,testnet:B.testnet,gateway:B.gateway,trafficStats:B.analytics};J=await Gb(W,$,K)}else J=await v($);await K1(J,$,K),h(`Restore complete! Your Seed node is running.
${x1}`)}async function p9($,K){o(`Seed Node Uninstall v${C}`),E(["This will permanently delete:","  - All Seed containers",`  - All node data at ${$.seedDir}/ (daemon identity, web data, config)`,"  - Cron jobs for seed-deploy and seed-cleanup","","This action is IRREVERSIBLE."].join(`
`),"Warning");let Y=await w({message:"Would you like to create a backup before uninstalling?",initialValue:!0});if(!k(Y)&&Y)await Sb($,K,[]);let Q=await c({message:'Type "yes" to confirm uninstallation:',validate:(x)=>{if(x!=="yes")return'Please type "yes" to confirm, or press Ctrl+C to cancel.'}});if(k(Q))f("Uninstall cancelled."),process.exit(0);console.log("Stopping and removing containers..."),K.runSafe(`docker compose -f "${$.composePath}" down`);let X=K.runSafe("crontab -l 2>/dev/null")??"";if(X.includes("# seed-deploy")||X.includes("# seed-cleanup")){let x=Pb(X);try{K.run(`echo '${x}' | crontab -`),console.log("Cron jobs removed.")}catch{console.log("Warning: Could not remove cron jobs.")}}console.log(`Removing ${$.seedDir}...`);try{K.run(`rm -rf "${$.seedDir}"`)}catch{console.log(`Could not remove ${$.seedDir}. Trying with sudo...`),K.run(`sudo rm -rf "${$.seedDir}"`)}h("Seed node uninstalled.")}async function r9(){let{command:$,args:K,reconfigure:Y}=E9(),Q=S9(),X=I9();switch($){case"help":Ob();return;case"version":console.log(C);return;case"deploy":return m9(Q,X,Y);case"stop":return Ab(Q,X);case"start":return Tb(Q,X);case"restart":return v9(Q,X);case"status":return f9(Q,X);case"config":return F9(Q);case"logs":return d9(Q,K);case"cron":return g9(Q,X,K);case"backup":return Sb(Q,X,K);case"restore":return u9(Q,X,K);case"uninstall":return p9(Q,X)}}if(import.meta.main)r9().catch(($)=>{console.error("Fatal error:",$),process.exit(1)});export{Q1 as writeConfig,j1 as sha256,Mb as setupCron,w9 as selfUpdate,Pb as removeSeedCronLines,v as readConfig,Ob as printHelp,_9 as parseWebEnv,N9 as parseImageTag,U9 as parseDaemonEnv,E9 as parseArgs,I9 as makeShellRunner,S9 as makePaths,I as log,L9 as inferEnvironment,y9 as getWorkspaceDirs,k9 as getContainerImages,zb as generateSecret,R9 as generateCaddyfile,c9 as extractSeedCronLines,Vb as extractDns,Wb as environmentPresets,w1 as ensureSeedDir,j9 as detectOldInstall,K1 as deploy,D as configExists,Xb as checkContainersHealthy,Hb as buildCrontab,y1 as buildComposeEnv,C as VERSION,k1 as OPS_BASE_URL,A9 as NOTIFY_SERVICE_HOST,P9 as LIGHTNING_URL_TESTNET,T9 as LIGHTNING_URL_MAINNET,Bb as DEFAULT_SEED_DIR,O9 as DEFAULT_REPO_URL,Jb as DEFAULT_COMPOSE_URL};
